<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script>
    <title>Document</title>
    <style>
        .ipAlert{
            width: 50px;
            height: 50px;
            background-color: antiquewhite;
        }
    </style>
</head>
<body>
    <div>
        <div>
            <label>IP address</label>
            <input placeholder="0.0.0.0" pattern="[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}" class='ipInput'/>
        </div>
        <div>
            <label>Hosts</label>
            <input placeholder="Hosts">
        </div>
        <div>
            <label>Subnets</label>
            <input type='number' placeholder="Subnets">
        </div>
        <div>
            <button>Calculate</button>
        </div>
    </div>
    <table border='1'>
        <thead>
          <tr>
            <th scope="col">IP class</th>
            <th scope="col">IP address range</th>
            <th scope="col">Subnet Mask</th>
            <th scope="col">Prefix Notation</th>
          </tr>
        </thead>
        <tbody>
        </tbody>
      </table>
</body>
<script>
    let calBtn = document.getElementsByTagName("button")[0]
    
    let ipclass = null;
    
   
    

    // $(".ipInput").change(()=>{
    //     var patt = new RegExp("[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}");
    //     var res = patt.test($(".ipInput").val());
    //     if( !patt.test( $(".ipInput").val()) ){
    //     alert("Subnet Form is wrong");
    //     return
    // }
    // })
    

    const decimal =  (m,n,type)=>{
            let subM1 = 0;
            let subM2 = 0;
            let subM3 = 0;
            let subM4 = 0;
            let subMask = `${subM1}.${subM2}.${subM3}.${subM4}`
            let subMaskDecimal = 0;
            let binaryArr = [Math.pow(2,7),Math.pow(2,6),Math.pow(2,5),Math.pow(2,4),Math.pow(2,3),Math.pow(2,2),Math.pow(2,1)]
            for(let i=0; i<=n; i++){
                subMaskDecimal += binaryArr[i]
            }
            if(type=="a"){
                subM1 = 250
                if(m==1){
                    subM2 = subMaskDecimal;
                }
                else if(m==2){
                    subM2 = 255;
                    subM3=subMaskDecimal
                }else if(m==3){
                    subM2 = 255;
                    subM3 = 255;
                    subM4 =subMaskDecimal
                }
            }else if(type=="b"){
                subM1 = 255;
                subM2 = 255;
                if(m==1){
                    subM3 = subMaskDecimal;
                }else if(m==2){
                    subM3=255
                    subM4 =subMaskDecimal
                }
            }else if(type=="c"){
                subM1 = 255;
                subM2 = 255;
                subM3 = 255;
                subM4 = subMaskDecimal;
            }
            subMask = `${subM1}.${subM2}.${subM3}.${subM4}`
            return subMask
    }

    const displayTable = (tmpArr,error) => {
        let arr = [...tmpArr]
        let tr = document.createElement("tr")
        let tbody = document.getElementsByTagName("tbody")[0]
        console.log(error);
        if(error=="over"||error=="No value"){
            alert(error)
        }else{
            for(let val of arr){
                let td = document.createElement("td")
                td.innerText = val
                tr.appendChild(td)
            }
            tbody.appendChild(tr)
        }
    }

    const ipClass = () => {
        let subnet = parseInt(document.getElementsByTagName("input")[2].value)
        let ipAdd = document.getElementsByTagName("input")[0].value
        let ipStr = String(ipAdd).split(".")
        let firstOctet = parseInt(ipStr[0])
        let secondOctet = parseInt(ipStr[1])
        let thirdOctet = parseInt(ipStr[2])
        let fourthOctet = parseInt(ipStr[3])
        let subnetMask = 0;
        let prefix = 0;
        let err = ""
        
            for(let i=0; i<4; i++){
                if(ipStr[i].length>0&&ipStr[i].length<4){
                if(firstOctet>=000 && firstOctet<=127){
                ipclass = "A"
                if(subnet==2**0){subnetMask = decimal(0,"a"); prefix=8;}
                else if (subnet==2**1){subnetMask = decimal(1,1,"a"); prefix=9}
                else if (subnet>=2**1+1 && subnet<=2**2){subnetMask = decimal(1,2,"a"); prefix=10}
                else if (subnet>=2**2+1 && subnet<=2**3){subnetMask = decimal(1,3,"a"); prefix=11}
                else if (subnet>=2**3+1 && subnet<=2**4){subnetMask = decimal(1,4,"a"); prefix=12}
                else if (subnet>=2**4+1 && subnet<=2**5){subnetMask = decimal(1,5,"a"); prefix=13}
                else if (subnet>=2**5+1 && subnet<=2**6){subnetMask = decimal(1,6,"a"); prefix=14}
                else if (subnet>=2**6+1 && subnet<=2**7){subnetMask = decimal(1,7,"a"); prefix=15}
                else if (subnet>=2**7+1 && subnet<=2**8){subnetMask = decimal(2,0,"a"); prefix=16}
                else if (subnet>=2**8+1 && subnet<=2**9){subnetMask = decimal(2,1,"a"); prefix=17}
                else if (subnet>=2**9+1 && subnet<=2**10){subnetMask = decimal(2,2,"a"); prefix=18}
                else if (subnet>=2**10+1 && subnet<=2**11){subnetMask = decimal(2,3,"a"); prefix=19}
                else if (subnet>=2**11+1 && subnet<=2**12){subnetMask = decimal(2,4,"a"); prefix=20}
                else if (subnet>=2**12+1 && subnet<=2**13){subnetMask = decimal(2,5,"a"); prefix=21}
                else if (subnet>=2**13+1 && subnet<=2**14){subnetMask = decimal(2,6,"a"); prefix=22}
                else if (subnet>=2**14+1 && subnet<=2**15){subnetMask = decimal(2,7,"a"); prefix=23}
                else if (subnet>=2**15+1 && subnet<=2**16){subnetMask = decimal(3,0,"a"); prefix=24}
                else if (subnet>=2**16+1 && subnet<=2**17){subnetMask = decimal(3,1,"a"); prefix=25}
                else if (subnet>=2**17+1 && subnet<=2**18){subnetMask = decimal(3,2,"a"); prefix=26}
                else if (subnet>=2**18+1 && subnet<=2**19){subnetMask = decimal(3,3,"a"); prefix=27}
                else if (subnet>=2**19+1 && subnet<=2**20){subnetMask = decimal(3,4,"a"); prefix=28}
                else if (subnet>=2**20+1 && subnet<=2**21){subnetMask = decimal(3,5,"a"); prefix=29}
                else if (subnet>=2**21+1 && subnet<=2**22){subnetMask = decimal(3,6,"a"); prefix=30}
                else{err="over"}
    
            }else if (firstOctet>=128 && firstOctet<=191){
                ipclass = "B"
                if(subnet==2**0){subnetMask = decimal(0,"b"); prefix=16;}
                else if (subnet==2**1){subnetMask = decimal(1,1,"b"); prefix=17;}
                else if (subnet>=2**1+1 && subnet<=2**2){subnetMask = decimal(1,2,"b"); prefix=18;}
                else if (subnet>=2**2+1 && subnet<=2**3){subnetMask = decimal(1,3,"b"); prefix=19}
                else if (subnet>=2**3+1 && subnet<=2**4){subnetMask = decimal(1,4,"b"); prefix=20}
                else if (subnet>=2**4+1 && subnet<=2**5){subnetMask = decimal(1,5,"b"); prefix=21}
                else if (subnet>=2**5+1 && subnet<=2**6){subnetMask = decimal(1,6,"b"); prefix=22}
                else if (subnet>=2**6+1 && subnet<=2**7){subnetMask = decimal(1,7,"b"); prefix=23}
                else if (subnet>=2**7+1 && subnet<=2**8){subnetMask = decimal(2,0,"b"); prefix=24}
                else if (subnet>=2**8+1 && subnet<=2**9){subnetMask = decimal(2,1,"b"); prefix=25}
                else if (subnet>=2**9+1 && subnet<=2**10){subnetMask = decimal(2,2,"b"); prefix=26}
                else if (subnet>=2**10+1 && subnet<=2**11){subnetMask = decimal(2,3,"b"); prefix=27}
                else if (subnet>=2**11+1 && subnet<=2**12){subnetMask = decimal(2,4,"b"); prefix=28}
                else if (subnet>=2**12+1 && subnet<=2**13){subnetMask = decimal(2,5,"b"); prefix=29}
                else if (subnet>=2**13+1 && subnet<=2**14){subnetMask = decimal(2,6,"b"); prefix=30}
                else{err="over"}
    
            }else if(firstOctet>=192 && firstOctet<=223){
                ipclass = "C"
                subM1 = 255;
                subM2 = 255;
                subM3 = 255;
                if(subnet==2**0){subnetMask = decimal(1,0,"c"); prefix=24; }
                else if (subnet==2**1){subnetMask = decimal(1,1,"c"); prefix=25;}
                else if (subnet>=2**1+1 && subnet<=2**2){subnetMask = decimal(1,2,"c"); prefix=26;}
                else if (subnet>=2**2+1 && subnet<=2**3){subnetMask = decimal(1,3,"c"); prefix=27}
                else if (subnet>=2**3+1 && subnet<=2**4){subnetMask = decimal(1,4,"c"); prefix=28}
                else if (subnet>=2**4+1 && subnet<=2**5){subnetMask = decimal(1,5,"c"); prefix=29}
                else if (subnet>=2**5+1 && subnet<=2**6){subnetMask = decimal(1,6,"c"); prefix=30}
                else{err="over"}
            }else{
                ipclass = "The IP class is D or E"
            }
        }else{
            return 
        }
    }
          
 
            
        console.log(ipAdd);
        console.log(firstOctet);
        console.log(ipclass);
        console.log(subnetMask);
        console.log(prefix);
        let displayArr = [ipclass,0,subnetMask,prefix]
        displayTable(displayArr,err)
}
    
    calBtn.addEventListener("click",ipClass)

</script>
</html>